(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{387:function(t,a,s){"use strict";s.r(a);var n=s(42),v=Object(n.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"pipelines-de-modelos"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#pipelines-de-modelos"}},[t._v("#")]),t._v(" Pipelines de modelos")]),t._v(" "),s("p",[t._v("En esta sección ilustraremos cómo estructurar nuestros proyectos para migrarlos fácilmente a un entorno de producción. Esto significa, adaptarnos a escribir código de manera que sea lo más fácil posible de distribuirlo e integrarlo con otros servicios. Vamos a ilustrar el procedimiento con unos datos reales.")]),t._v(" "),s("h2",{attrs:{id:"lectura-y-pre-procesado"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#lectura-y-pre-procesado"}},[t._v("#")]),t._v(" Lectura y pre-procesado")]),t._v(" "),s("p",[t._v("Comenzamos leyendo los datos, que se encuentran en un archivo "),s("code",[t._v(".csv")])]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" pandas "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" pd\n\ndf "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" pd"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("read_csv"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'data/german_train.csv'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\ndf\n")])])]),s("div",[s("style",{attrs:{scoped:""}},[t._v('\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\x3c!--beforebegin--\x3e<div class="language- extra-class">\x3c!--afterbegin--\x3e<pre><code>.dataframe tbody tr th {\n    vertical-align: top;\n}\n\n.dataframe thead th {\n    text-align: right;\n}\n</code></pre>\n\x3c!--beforeend--\x3e</div>\x3c!--afterend--\x3e')]),t._v(" "),s("table",{staticClass:"dataframe",attrs:{border:"1"}},[s("thead",[s("tr",{staticStyle:{"text-align":"right"}},[s("th"),t._v(" "),s("th",[t._v("DurationMonth")]),t._v(" "),s("th",[t._v("CreditAmount")]),t._v(" "),s("th",[t._v("Age")]),t._v(" "),s("th",[t._v("ResidenceSince")]),t._v(" "),s("th",[t._v("StatusAccount")]),t._v(" "),s("th",[t._v("CreditHistory")]),t._v(" "),s("th",[t._v("Purpose")]),t._v(" "),s("th",[t._v("SavingsAccount")]),t._v(" "),s("th",[t._v("EmploymentSince")]),t._v(" "),s("th",[t._v("StatusAndSex")]),t._v(" "),s("th",[t._v("...")]),t._v(" "),s("th",[t._v("InstallmentPlans")]),t._v(" "),s("th",[t._v("Housing")]),t._v(" "),s("th",[t._v("Job")]),t._v(" "),s("th",[t._v("Telephone")]),t._v(" "),s("th",[t._v("ForeignWorker")]),t._v(" "),s("th",[t._v("Customer")]),t._v(" "),s("th",[t._v("NCredits")]),t._v(" "),s("th",[t._v("NPeopleMain")]),t._v(" "),s("th",[t._v("InstallmentRate")]),t._v(" "),s("th",[t._v("index")])])]),t._v(" "),s("tbody",[s("tr",[s("th",[t._v("0")]),t._v(" "),s("td",[t._v("35")]),t._v(" "),s("td",[t._v("942")]),t._v(" "),s("td",[t._v("29")]),t._v(" "),s("td",[t._v("2.0")]),t._v(" "),s("td",[t._v("A14")]),t._v(" "),s("td",[t._v("A34")]),t._v(" "),s("td",[t._v("A43")]),t._v(" "),s("td",[t._v("A65")]),t._v(" "),s("td",[t._v("A73")]),t._v(" "),s("td",[t._v("A93")]),t._v(" "),s("td",[t._v("...")]),t._v(" "),s("td",[t._v("A143")]),t._v(" "),s("td",[t._v("A152")]),t._v(" "),s("td",[t._v("A172")]),t._v(" "),s("td",[t._v("A191")]),t._v(" "),s("td",[t._v("A201")]),t._v(" "),s("td",[t._v("1")]),t._v(" "),s("td",[t._v("1.0")]),t._v(" "),s("td",[t._v("1")]),t._v(" "),s("td",[t._v("1")]),t._v(" "),s("td",[t._v("0")])]),t._v(" "),s("tr",[s("th",[t._v("1")]),t._v(" "),s("td",[t._v("60")]),t._v(" "),s("td",[t._v("10955")]),t._v(" "),s("td",[t._v("52")]),t._v(" "),s("td",[t._v("2.0")]),t._v(" "),s("td",[t._v("A11")]),t._v(" "),s("td",[t._v("A32")]),t._v(" "),s("td",[t._v("A43")]),t._v(" "),s("td",[t._v("A65")]),t._v(" "),s("td",[t._v("A74")]),t._v(" "),s("td",[t._v("A93")]),t._v(" "),s("td",[t._v("...")]),t._v(" "),s("td",[t._v("A143")]),t._v(" "),s("td",[t._v("A152")]),t._v(" "),s("td",[t._v("A173")]),t._v(" "),s("td",[t._v("A191")]),t._v(" "),s("td",[t._v("A201")]),t._v(" "),s("td",[t._v("2")]),t._v(" "),s("td",[t._v("1.0")]),t._v(" "),s("td",[t._v("1")]),t._v(" "),s("td",[t._v("2")]),t._v(" "),s("td",[t._v("1")])]),t._v(" "),s("tr",[s("th",[t._v("2")]),t._v(" "),s("td",[t._v("21")]),t._v(" "),s("td",[t._v("1481")]),t._v(" "),s("td",[t._v("34")]),t._v(" "),s("td",[t._v("2.0")]),t._v(" "),s("td",[t._v("A14")]),t._v(" "),s("td",[t._v("A34")]),t._v(" "),s("td",[t._v("A40")]),t._v(" "),s("td",[t._v("A61")]),t._v(" "),s("td",[t._v("A73")]),t._v(" "),s("td",[t._v("A93")]),t._v(" "),s("td",[t._v("...")]),t._v(" "),s("td",[t._v("A143")]),t._v(" "),s("td",[t._v("A152")]),t._v(" "),s("td",[t._v("A172")]),t._v(" "),s("td",[t._v("A191")]),t._v(" "),s("td",[t._v("A201")]),t._v(" "),s("td",[t._v("1")]),t._v(" "),s("td",[t._v("2.0")]),t._v(" "),s("td",[t._v("1")]),t._v(" "),s("td",[t._v("3")]),t._v(" "),s("td",[t._v("2")])]),t._v(" "),s("tr",[s("th",[t._v("3")]),t._v(" "),s("td",[t._v("48")]),t._v(" "),s("td",[t._v("1431")]),t._v(" "),s("td",[t._v("27")]),t._v(" "),s("td",[t._v("4.0")]),t._v(" "),s("td",[t._v("A11")]),t._v(" "),s("td",[t._v("A32")]),t._v(" "),s("td",[t._v("A40")]),t._v(" "),s("td",[t._v("A61")]),t._v(" "),s("td",[t._v("A72")]),t._v(" "),s("td",[t._v("A92")]),t._v(" "),s("td",[t._v("...")]),t._v(" "),s("td",[t._v("A143")]),t._v(" "),s("td",[t._v("A152")]),t._v(" "),s("td",[t._v("A173")]),t._v(" "),s("td",[t._v("A192")]),t._v(" "),s("td",[t._v("A201")]),t._v(" "),s("td",[t._v("2")]),t._v(" "),s("td",[t._v("1.0")]),t._v(" "),s("td",[t._v("1")]),t._v(" "),s("td",[t._v("3")]),t._v(" "),s("td",[t._v("3")])]),t._v(" "),s("tr",[s("th",[t._v("4")]),t._v(" "),s("td",[t._v("10")]),t._v(" "),s("td",[t._v("1523")]),t._v(" "),s("td",[t._v("28")]),t._v(" "),s("td",[t._v("2.0")]),t._v(" "),s("td",[t._v("A12")]),t._v(" "),s("td",[t._v("A32")]),t._v(" "),s("td",[t._v("A43")]),t._v(" "),s("td",[t._v("A61")]),t._v(" "),s("td",[t._v("A73")]),t._v(" "),s("td",[t._v("A92")]),t._v(" "),s("td",[t._v("...")]),t._v(" "),s("td",[t._v("A143")]),t._v(" "),s("td",[t._v("A152")]),t._v(" "),s("td",[t._v("A173")]),t._v(" "),s("td",[t._v("A192")]),t._v(" "),s("td",[t._v("A201")]),t._v(" "),s("td",[t._v("2")]),t._v(" "),s("td",[t._v("1.0")]),t._v(" "),s("td",[t._v("1")]),t._v(" "),s("td",[t._v("3")]),t._v(" "),s("td",[t._v("4")])]),t._v(" "),s("tr",[s("th",[t._v("...")]),t._v(" "),s("td",[t._v("...")]),t._v(" "),s("td",[t._v("...")]),t._v(" "),s("td",[t._v("...")]),t._v(" "),s("td",[t._v("...")]),t._v(" "),s("td",[t._v("...")]),t._v(" "),s("td",[t._v("...")]),t._v(" "),s("td",[t._v("...")]),t._v(" "),s("td",[t._v("...")]),t._v(" "),s("td",[t._v("...")]),t._v(" "),s("td",[t._v("...")]),t._v(" "),s("td",[t._v("...")]),t._v(" "),s("td",[t._v("...")]),t._v(" "),s("td",[t._v("...")]),t._v(" "),s("td",[t._v("...")]),t._v(" "),s("td",[t._v("...")]),t._v(" "),s("td",[t._v("...")]),t._v(" "),s("td",[t._v("...")]),t._v(" "),s("td",[t._v("...")]),t._v(" "),s("td",[t._v("...")]),t._v(" "),s("td",[t._v("...")]),t._v(" "),s("td",[t._v("...")])]),t._v(" "),s("tr",[s("th",[t._v("9995")]),t._v(" "),s("td",[t._v("12")]),t._v(" "),s("td",[t._v("1206")]),t._v(" "),s("td",[t._v("37")]),t._v(" "),s("td",[t._v("4.0")]),t._v(" "),s("td",[t._v("A14")]),t._v(" "),s("td",[t._v("A34")]),t._v(" "),s("td",[t._v("A46")]),t._v(" "),s("td",[t._v("A61")]),t._v(" "),s("td",[t._v("A75")]),t._v(" "),s("td",[t._v("A92")]),t._v(" "),s("td",[t._v("...")]),t._v(" "),s("td",[t._v("A143")]),t._v(" "),s("td",[t._v("A152")]),t._v(" "),s("td",[t._v("A173")]),t._v(" "),s("td",[t._v("A192")]),t._v(" "),s("td",[t._v("A201")]),t._v(" "),s("td",[t._v("1")]),t._v(" "),s("td",[t._v("1.0")]),t._v(" "),s("td",[t._v("1")]),t._v(" "),s("td",[t._v("4")]),t._v(" "),s("td",[t._v("9995")])]),t._v(" "),s("tr",[s("th",[t._v("9996")]),t._v(" "),s("td",[t._v("10")]),t._v(" "),s("td",[t._v("8341")]),t._v(" "),s("td",[t._v("35")]),t._v(" "),s("td",[t._v("4.0")]),t._v(" "),s("td",[t._v("A12")]),t._v(" "),s("td",[t._v("A32")]),t._v(" "),s("td",[t._v("A43")]),t._v(" "),s("td",[t._v("A61")]),t._v(" "),s("td",[t._v("A72")]),t._v(" "),s("td",[t._v("A93")]),t._v(" "),s("td",[t._v("...")]),t._v(" "),s("td",[t._v("A143")]),t._v(" "),s("td",[t._v("A152")]),t._v(" "),s("td",[t._v("A173")]),t._v(" "),s("td",[t._v("A191")]),t._v(" "),s("td",[t._v("A201")]),t._v(" "),s("td",[t._v("1")]),t._v(" "),s("td",[t._v("2.0")]),t._v(" "),s("td",[t._v("1")]),t._v(" "),s("td",[t._v("2")]),t._v(" "),s("td",[t._v("9996")])]),t._v(" "),s("tr",[s("th",[t._v("9997")]),t._v(" "),s("td",[t._v("5")]),t._v(" "),s("td",[t._v("252")]),t._v(" "),s("td",[t._v("47")]),t._v(" "),s("td",[t._v("4.0")]),t._v(" "),s("td",[t._v("A11")]),t._v(" "),s("td",[t._v("A34")]),t._v(" "),s("td",[t._v("A46")]),t._v(" "),s("td",[t._v("A61")]),t._v(" "),s("td",[t._v("A75")]),t._v(" "),s("td",[t._v("A93")]),t._v(" "),s("td",[t._v("...")]),t._v(" "),s("td",[t._v("A143")]),t._v(" "),s("td",[t._v("A152")]),t._v(" "),s("td",[t._v("A173")]),t._v(" "),s("td",[t._v("A191")]),t._v(" "),s("td",[t._v("A201")]),t._v(" "),s("td",[t._v("1")]),t._v(" "),s("td",[t._v("2.0")]),t._v(" "),s("td",[t._v("1")]),t._v(" "),s("td",[t._v("4")]),t._v(" "),s("td",[t._v("9997")])]),t._v(" "),s("tr",[s("th",[t._v("9998")]),t._v(" "),s("td",[t._v("9")]),t._v(" "),s("td",[t._v("455")]),t._v(" "),s("td",[t._v("32")]),t._v(" "),s("td",[t._v("2.0")]),t._v(" "),s("td",[t._v("A14")]),t._v(" "),s("td",[t._v("A32")]),t._v(" "),s("td",[t._v("A43")]),t._v(" "),s("td",[t._v("A61")]),t._v(" "),s("td",[t._v("A73")]),t._v(" "),s("td",[t._v("A93")]),t._v(" "),s("td",[t._v("...")]),t._v(" "),s("td",[t._v("A143")]),t._v(" "),s("td",[t._v("A152")]),t._v(" "),s("td",[t._v("A173")]),t._v(" "),s("td",[t._v("A191")]),t._v(" "),s("td",[t._v("A201")]),t._v(" "),s("td",[t._v("1")]),t._v(" "),s("td",[t._v("2.0")]),t._v(" "),s("td",[t._v("1")]),t._v(" "),s("td",[t._v("2")]),t._v(" "),s("td",[t._v("9998")])]),t._v(" "),s("tr",[s("th",[t._v("9999")]),t._v(" "),s("td",[t._v("13")]),t._v(" "),s("td",[t._v("692")]),t._v(" "),s("td",[t._v("55")]),t._v(" "),s("td",[t._v("2.0")]),t._v(" "),s("td",[t._v("A14")]),t._v(" "),s("td",[t._v("A32")]),t._v(" "),s("td",[t._v("A43")]),t._v(" "),s("td",[t._v("A61")]),t._v(" "),s("td",[t._v("A75")]),t._v(" "),s("td",[t._v("A93")]),t._v(" "),s("td",[t._v("...")]),t._v(" "),s("td",[t._v("A141")]),t._v(" "),s("td",[t._v("A152")]),t._v(" "),s("td",[t._v("A173")]),t._v(" "),s("td",[t._v("A191")]),t._v(" "),s("td",[t._v("A201")]),t._v(" "),s("td",[t._v("2")]),t._v(" "),s("td",[t._v("1.0")]),t._v(" "),s("td",[t._v("2")]),t._v(" "),s("td",[t._v("3")]),t._v(" "),s("td",[t._v("9999")])])])]),t._v(" "),s("p",[t._v("10000 rows × 22 columns")])]),t._v(" "),s("p",[t._v("En esta primera sesión trabajaremos con la variable "),s("code",[t._v("CreditAmount")]),t._v(". Nuestro objetivo es crear un modelo muy sencillo que, dado un "),s("code",[t._v("CreditAmount")]),t._v(" devuelva una categoría (e.g. "),s("code",[t._v("low, high, very high")]),t._v("). Esto se puede conseguir de formas más sencillas, pero es un simple ejemplo para ilustrar el manejo de datos.")]),t._v(" "),s("p",[t._v("Vamos a echarle un vistazo a la variable "),s("code",[t._v("CreditAmount")])]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" plotly"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("express "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" px\npx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("histogram"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("df"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" x"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"CreditAmount"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" nbins"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("20")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("h2",{attrs:{id:"experimentando-con-el-modelo"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#experimentando-con-el-modelo"}},[t._v("#")]),t._v(" Experimentando con el modelo")]),t._v(" "),s("p",[t._v("Vamos a clasificar los tipos de créditos basados en los cuantiles, de forma que "),s("code",[t._v("[0, 0.5] -> low")]),t._v(", "),s("code",[t._v("(0.5, 0.95] -> high")]),t._v(", "),s("code",[t._v("(0.95, 1.0] -> very high")]),t._v(". Para calcular cuantiles, usamos la clase "),s("code",[t._v("QuantileTransformer")]),t._v(" de "),s("code",[t._v("sklearn.preprocessing")]),t._v(".")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" sklearn"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("preprocessing "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" QuantileTransformer\namt_transformer "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" QuantileTransformer"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("n_quantiles"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("50")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[t._v("amt_transformer"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("fit_transform"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("df"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'CreditAmount'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("div",{staticClass:"language- extra-class"},[s("pre",[s("code",[t._v("array([[0.2169241 ],\n       [0.97365707],\n       [0.42232143],\n       ...,\n       [0.00104493],\n       [0.06374534],\n       [0.12380952]])\n")])])]),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[t._v("df"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("loc"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Q'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" amt_transformer"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("fit_transform"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("df"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'CreditAmount'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\ndf"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'CreditAmount'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Q'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n")])])]),s("div",[s("style",{attrs:{scoped:""}},[t._v('\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\x3c!--beforebegin--\x3e<div class="language- extra-class">\x3c!--afterbegin--\x3e<pre><code>.dataframe tbody tr th {\n    vertical-align: top;\n}\n\n.dataframe thead th {\n    text-align: right;\n}\n</code></pre>\n\x3c!--beforeend--\x3e</div>\x3c!--afterend--\x3e')]),t._v(" "),s("table",{staticClass:"dataframe",attrs:{border:"1"}},[s("thead",[s("tr",{staticStyle:{"text-align":"right"}},[s("th"),t._v(" "),s("th",[t._v("CreditAmount")]),t._v(" "),s("th",[t._v("Q")])])]),t._v(" "),s("tbody",[s("tr",[s("th",[t._v("0")]),t._v(" "),s("td",[t._v("942")]),t._v(" "),s("td",[t._v("0.216924")])]),t._v(" "),s("tr",[s("th",[t._v("1")]),t._v(" "),s("td",[t._v("10955")]),t._v(" "),s("td",[t._v("0.973657")])]),t._v(" "),s("tr",[s("th",[t._v("2")]),t._v(" "),s("td",[t._v("1481")]),t._v(" "),s("td",[t._v("0.422321")])]),t._v(" "),s("tr",[s("th",[t._v("3")]),t._v(" "),s("td",[t._v("1431")]),t._v(" "),s("td",[t._v("0.404626")])]),t._v(" "),s("tr",[s("th",[t._v("4")]),t._v(" "),s("td",[t._v("1523")]),t._v(" "),s("td",[t._v("0.438776")])]),t._v(" "),s("tr",[s("th",[t._v("...")]),t._v(" "),s("td",[t._v("...")]),t._v(" "),s("td",[t._v("...")])]),t._v(" "),s("tr",[s("th",[t._v("9995")]),t._v(" "),s("td",[t._v("1206")]),t._v(" "),s("td",[t._v("0.298186")])]),t._v(" "),s("tr",[s("th",[t._v("9996")]),t._v(" "),s("td",[t._v("8341")]),t._v(" "),s("td",[t._v("0.944176")])]),t._v(" "),s("tr",[s("th",[t._v("9997")]),t._v(" "),s("td",[t._v("252")]),t._v(" "),s("td",[t._v("0.001045")])]),t._v(" "),s("tr",[s("th",[t._v("9998")]),t._v(" "),s("td",[t._v("455")]),t._v(" "),s("td",[t._v("0.063745")])]),t._v(" "),s("tr",[s("th",[t._v("9999")]),t._v(" "),s("td",[t._v("692")]),t._v(" "),s("td",[t._v("0.123810")])])])]),t._v(" "),s("p",[t._v("10000 rows × 2 columns")])]),t._v(" "),s("h2",{attrs:{id:"escribiendo-la-transformacion-como-una-clase"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#escribiendo-la-transformacion-como-una-clase"}},[t._v("#")]),t._v(" Escribiendo la transformación como una clase")]),t._v(" "),s("p",[t._v("Vamos a convertir esta sencilla transformación en una clase, con métodos "),s("code",[t._v("fit_transform")]),t._v(", "),s("code",[t._v("transform")]),t._v(" y "),s("code",[t._v("__repr__")]),t._v(".")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" sklearn"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("preprocessing "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" QuantileTransformer\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" pandas "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" pd\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" random\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" string\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("generate_id")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" chars"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("string"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("hexdigits"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("join"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("random"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("choice"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("chars"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" _ "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("range")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("MyPipe")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    \n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("__init__")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("self"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        self"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("id")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" generate_id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        self"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("amt_transformer "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("None")]),t._v("\n    \n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("fit_transform")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("self"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        self"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("amt_transformer "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" QuantileTransformer"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("n_quantiles"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("50")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("loc"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Q'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" self"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("amt_transformer"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("fit_transform"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'CreditAmount'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Q'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'CreditAmount'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n    \n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("transform")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("self"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("loc"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Q'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" self"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("amt_transformer"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("transform"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'CreditAmount'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Q'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'CreditAmount'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("__repr__")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("self"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string-interpolation"}},[s("span",{pre:!0,attrs:{class:"token string"}},[t._v("f'MyPipe object with id ")]),s("span",{pre:!0,attrs:{class:"token interpolation"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("self"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("id")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'")])]),t._v("\n")])])]),s("p",[t._v("Ahora podemos ajustar y transformar datos con muestro pipe de transformación.")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[t._v("pipe "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" MyPipe"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\npipe\n")])])]),s("div",{staticClass:"language- extra-class"},[s("pre",[s("code",[t._v("MyPipe object with id 52fa\n")])])]),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[t._v("pipe"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("fit_transform"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("df"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("div",[s("style",{attrs:{scoped:""}},[t._v('\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\x3c!--beforebegin--\x3e<div class="language- extra-class">\x3c!--afterbegin--\x3e<pre><code>.dataframe tbody tr th {\n    vertical-align: top;\n}\n\n.dataframe thead th {\n    text-align: right;\n}\n</code></pre>\n\x3c!--beforeend--\x3e</div>\x3c!--afterend--\x3e')]),t._v(" "),s("table",{staticClass:"dataframe",attrs:{border:"1"}},[s("thead",[s("tr",{staticStyle:{"text-align":"right"}},[s("th"),t._v(" "),s("th",[t._v("Q")]),t._v(" "),s("th",[t._v("CreditAmount")])])]),t._v(" "),s("tbody",[s("tr",[s("th",[t._v("0")]),t._v(" "),s("td",[t._v("0.216924")]),t._v(" "),s("td",[t._v("942")])]),t._v(" "),s("tr",[s("th",[t._v("1")]),t._v(" "),s("td",[t._v("0.973657")]),t._v(" "),s("td",[t._v("10955")])]),t._v(" "),s("tr",[s("th",[t._v("2")]),t._v(" "),s("td",[t._v("0.422321")]),t._v(" "),s("td",[t._v("1481")])]),t._v(" "),s("tr",[s("th",[t._v("3")]),t._v(" "),s("td",[t._v("0.404626")]),t._v(" "),s("td",[t._v("1431")])]),t._v(" "),s("tr",[s("th",[t._v("4")]),t._v(" "),s("td",[t._v("0.438776")]),t._v(" "),s("td",[t._v("1523")])]),t._v(" "),s("tr",[s("th",[t._v("...")]),t._v(" "),s("td",[t._v("...")]),t._v(" "),s("td",[t._v("...")])]),t._v(" "),s("tr",[s("th",[t._v("9995")]),t._v(" "),s("td",[t._v("0.298186")]),t._v(" "),s("td",[t._v("1206")])]),t._v(" "),s("tr",[s("th",[t._v("9996")]),t._v(" "),s("td",[t._v("0.944176")]),t._v(" "),s("td",[t._v("8341")])]),t._v(" "),s("tr",[s("th",[t._v("9997")]),t._v(" "),s("td",[t._v("0.001045")]),t._v(" "),s("td",[t._v("252")])]),t._v(" "),s("tr",[s("th",[t._v("9998")]),t._v(" "),s("td",[t._v("0.063745")]),t._v(" "),s("td",[t._v("455")])]),t._v(" "),s("tr",[s("th",[t._v("9999")]),t._v(" "),s("td",[t._v("0.123810")]),t._v(" "),s("td",[t._v("692")])])])]),t._v(" "),s("p",[t._v("10000 rows × 2 columns")])]),t._v(" "),s("h2",{attrs:{id:"anadiendo-un-modelo"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#anadiendo-un-modelo"}},[t._v("#")]),t._v(" Añadiendo un modelo")]),t._v(" "),s("p",[t._v("Ahora vamos a añadir el modelo que utiliza la columna "),s("code",[t._v("Q")]),t._v(" para clasificar los créditos.")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" joblib "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" dump"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" load\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("MyModel")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    \n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("__init__")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("self"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        self"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("id")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" generate_id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        self"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("pipe "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" MyPipe"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        self"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("rules "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'low'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.5")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'high'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.95")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'very-high'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        \n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("fit")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("self"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        data "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" self"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("pipe"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("fit_transform"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    \n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("predict")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("self"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        data "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" self"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("pipe"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("transform"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        pred "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("len")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" i "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("range")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("len")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n            q "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Q"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("values"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("i"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" k "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" self"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("rules"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("keys"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n                "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" self"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("rules"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("k"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" q"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n                    pred"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("i"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" k\n                    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("break")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" pd"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("DataFrame"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'prediction'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" pred"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Q'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Q"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'CreditAmount'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("CreditAmount"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    \n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("__repr__")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("self"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string-interpolation"}},[s("span",{pre:!0,attrs:{class:"token string"}},[t._v("f'MyModel with id ")]),s("span",{pre:!0,attrs:{class:"token interpolation"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("self"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("id")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'")])]),t._v("\n    \n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("save")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("self"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" path"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        dump"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("self"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string-interpolation"}},[s("span",{pre:!0,attrs:{class:"token string"}},[t._v("f'")]),s("span",{pre:!0,attrs:{class:"token interpolation"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("path"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token interpolation"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("self"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("id")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    \n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("load")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("model_id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" path"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        obj "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" load"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string-interpolation"}},[s("span",{pre:!0,attrs:{class:"token string"}},[t._v("f'")]),s("span",{pre:!0,attrs:{class:"token interpolation"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("path"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token interpolation"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("model_id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" obj\n")])])]),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[t._v("model "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" MyModel"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nmodel\n")])])]),s("div",{staticClass:"language- extra-class"},[s("pre",[s("code",[t._v("MyModel with id c3e5\n")])])]),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[t._v("model"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("fit"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("df"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[t._v("model"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("predict"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("df"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("div",[s("style",{attrs:{scoped:""}},[t._v('\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\x3c!--beforebegin--\x3e<div class="language- extra-class">\x3c!--afterbegin--\x3e<pre><code>.dataframe tbody tr th {\n    vertical-align: top;\n}\n\n.dataframe thead th {\n    text-align: right;\n}\n</code></pre>\n\x3c!--beforeend--\x3e</div>\x3c!--afterend--\x3e')]),t._v(" "),s("table",{staticClass:"dataframe",attrs:{border:"1"}},[s("thead",[s("tr",{staticStyle:{"text-align":"right"}},[s("th"),t._v(" "),s("th",[t._v("prediction")]),t._v(" "),s("th",[t._v("Q")]),t._v(" "),s("th",[t._v("CreditAmount")])])]),t._v(" "),s("tbody",[s("tr",[s("th",[t._v("0")]),t._v(" "),s("td",[t._v("low")]),t._v(" "),s("td",[t._v("0.216924")]),t._v(" "),s("td",[t._v("942")])]),t._v(" "),s("tr",[s("th",[t._v("1")]),t._v(" "),s("td",[t._v("very-high")]),t._v(" "),s("td",[t._v("0.973657")]),t._v(" "),s("td",[t._v("10955")])]),t._v(" "),s("tr",[s("th",[t._v("2")]),t._v(" "),s("td",[t._v("low")]),t._v(" "),s("td",[t._v("0.422321")]),t._v(" "),s("td",[t._v("1481")])]),t._v(" "),s("tr",[s("th",[t._v("3")]),t._v(" "),s("td",[t._v("low")]),t._v(" "),s("td",[t._v("0.404626")]),t._v(" "),s("td",[t._v("1431")])]),t._v(" "),s("tr",[s("th",[t._v("4")]),t._v(" "),s("td",[t._v("low")]),t._v(" "),s("td",[t._v("0.438776")]),t._v(" "),s("td",[t._v("1523")])]),t._v(" "),s("tr",[s("th",[t._v("...")]),t._v(" "),s("td",[t._v("...")]),t._v(" "),s("td",[t._v("...")]),t._v(" "),s("td",[t._v("...")])]),t._v(" "),s("tr",[s("th",[t._v("9995")]),t._v(" "),s("td",[t._v("low")]),t._v(" "),s("td",[t._v("0.298186")]),t._v(" "),s("td",[t._v("1206")])]),t._v(" "),s("tr",[s("th",[t._v("9996")]),t._v(" "),s("td",[t._v("high")]),t._v(" "),s("td",[t._v("0.944176")]),t._v(" "),s("td",[t._v("8341")])]),t._v(" "),s("tr",[s("th",[t._v("9997")]),t._v(" "),s("td",[t._v("low")]),t._v(" "),s("td",[t._v("0.001045")]),t._v(" "),s("td",[t._v("252")])]),t._v(" "),s("tr",[s("th",[t._v("9998")]),t._v(" "),s("td",[t._v("low")]),t._v(" "),s("td",[t._v("0.063745")]),t._v(" "),s("td",[t._v("455")])]),t._v(" "),s("tr",[s("th",[t._v("9999")]),t._v(" "),s("td",[t._v("low")]),t._v(" "),s("td",[t._v("0.123810")]),t._v(" "),s("td",[t._v("692")])])])]),t._v(" "),s("p",[t._v("10000 rows × 3 columns")])]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[t._v("model"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("save"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'sav'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[t._v("other_model "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" MyModel"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("load"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'c3e5'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'sav'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nother_model\n")])])]),s("div",{staticClass:"language- extra-class"},[s("pre",[s("code",[t._v("MyModel with id c3e5\n")])])]),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[t._v("other_model"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("predict"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("df"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("div",[s("style",{attrs:{scoped:""}},[t._v('\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\x3c!--beforebegin--\x3e<div class="language- extra-class">\x3c!--afterbegin--\x3e<pre><code>.dataframe tbody tr th {\n    vertical-align: top;\n}\n\n.dataframe thead th {\n    text-align: right;\n}\n</code></pre>\n\x3c!--beforeend--\x3e</div>\x3c!--afterend--\x3e')]),t._v(" "),s("table",{staticClass:"dataframe",attrs:{border:"1"}},[s("thead",[s("tr",{staticStyle:{"text-align":"right"}},[s("th"),t._v(" "),s("th",[t._v("prediction")]),t._v(" "),s("th",[t._v("Q")]),t._v(" "),s("th",[t._v("CreditAmount")])])]),t._v(" "),s("tbody",[s("tr",[s("th",[t._v("0")]),t._v(" "),s("td",[t._v("low")]),t._v(" "),s("td",[t._v("0.216924")]),t._v(" "),s("td",[t._v("942")])]),t._v(" "),s("tr",[s("th",[t._v("1")]),t._v(" "),s("td",[t._v("very-high")]),t._v(" "),s("td",[t._v("0.973657")]),t._v(" "),s("td",[t._v("10955")])]),t._v(" "),s("tr",[s("th",[t._v("2")]),t._v(" "),s("td",[t._v("low")]),t._v(" "),s("td",[t._v("0.422321")]),t._v(" "),s("td",[t._v("1481")])]),t._v(" "),s("tr",[s("th",[t._v("3")]),t._v(" "),s("td",[t._v("low")]),t._v(" "),s("td",[t._v("0.404626")]),t._v(" "),s("td",[t._v("1431")])]),t._v(" "),s("tr",[s("th",[t._v("4")]),t._v(" "),s("td",[t._v("low")]),t._v(" "),s("td",[t._v("0.438776")]),t._v(" "),s("td",[t._v("1523")])]),t._v(" "),s("tr",[s("th",[t._v("...")]),t._v(" "),s("td",[t._v("...")]),t._v(" "),s("td",[t._v("...")]),t._v(" "),s("td",[t._v("...")])]),t._v(" "),s("tr",[s("th",[t._v("9995")]),t._v(" "),s("td",[t._v("low")]),t._v(" "),s("td",[t._v("0.298186")]),t._v(" "),s("td",[t._v("1206")])]),t._v(" "),s("tr",[s("th",[t._v("9996")]),t._v(" "),s("td",[t._v("high")]),t._v(" "),s("td",[t._v("0.944176")]),t._v(" "),s("td",[t._v("8341")])]),t._v(" "),s("tr",[s("th",[t._v("9997")]),t._v(" "),s("td",[t._v("low")]),t._v(" "),s("td",[t._v("0.001045")]),t._v(" "),s("td",[t._v("252")])]),t._v(" "),s("tr",[s("th",[t._v("9998")]),t._v(" "),s("td",[t._v("low")]),t._v(" "),s("td",[t._v("0.063745")]),t._v(" "),s("td",[t._v("455")])]),t._v(" "),s("tr",[s("th",[t._v("9999")]),t._v(" "),s("td",[t._v("low")]),t._v(" "),s("td",[t._v("0.123810")]),t._v(" "),s("td",[t._v("692")])])])]),t._v(" "),s("p",[t._v("10000 rows × 3 columns")])]),t._v(" "),s("h2",{attrs:{id:"ejercicio"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ejercicio"}},[t._v("#")]),t._v(" Ejercicio")]),t._v(" "),s("p",[t._v("A la entidad bancaria le interesa asignar a cada cliente un clúster basado en la edad y la duración y la magnitud del crédito, de forma que obtenga los siguientes grupos:")]),t._v(" "),s("ul",[s("li",[t._v("Long-term credits, young people")]),t._v(" "),s("li",[t._v("Short-term credits, young people")]),t._v(" "),s("li",[t._v("Short-term credits, mature people")]),t._v(" "),s("li",[t._v("Long-term credits, small amounts, mature people")]),t._v(" "),s("li",[t._v("Long-term credits, large amounts, mature people")])]),t._v(" "),s("p",[t._v("Debes crear una estructura de modelo, de forma que, dado un diccionario con keys "),s("code",[t._v("'DurationMonths', 'Age', 'CreditAmount'")]),t._v(", el modelo retorne el clúster que corresponde.")])])}),[],!1,null,null,null);a.default=v.exports}}]);